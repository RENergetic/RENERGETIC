"use strict";(self["webpackChunkrenergetic_ui"]=self["webpackChunkrenergetic_ui"]||[]).push([[42],{7597:function(e,t,n){n.r(t),n.d(t,{default:function(){return we}});var i=n(6252);function s(e,t,n,s,l,a){const o=(0,i.up)("HeatMapView");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(o,{"heat-map":l.heatmap},null,8,["heat-map"])])}var l=n(9963),a=n(3577);const o={class:"grid"},d={class:"col-8"},c=(0,i.Uk)(" HeatMap View "),r={id:"heatmapContainer"},h={key:0,class:"col-3 ren"};function p(e,t,n,s,p,u){const m=(0,i.up)("DotMenu"),g=(0,i.up)("v-image"),f=(0,i.up)("v-layer"),y=(0,i.up)("v-stage"),b=(0,i.up)("Card"),k=(0,i.up)("MeasurementChart"),w=(0,i.up)("AreaDetails"),x=(0,i.up)("AccordionTab"),v=(0,i.up)("Accordion"),A=(0,i.up)("Listbox"),C=(0,i.up)("Tree"),K=(0,i.up)("recommendation-view"),T=(0,i.up)("notification-view"),M=(0,i.up)("measurements-view"),S=(0,i.up)("HeatMapSettings"),$=(0,i.up)("Dialog");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(m,{model:u.menuModel()},null,8,["model"]),(0,i._)("div",o,[(0,i._)("div",d,[(0,i.Wm)(b,null,{title:(0,i.w5)((()=>[c])),content:(0,i.w5)((()=>[(0,i._)("div",r,[(0,i.Wm)(y,{id:"heatmap",ref:"stage",config:p.stageSize,onClick:u.onClick},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{config:{image:p.bgImage}},null,8,["config"])])),_:1},512),[[l.F8,null!=p.bgImage]])])),_:1},8,["config","onClick"])])])),_:1}),p.selectedAreas&&Object.keys(p.selectedAreas).length>0&&p.measurmenentState?((0,i.wg)(),(0,i.j4)(k,{key:0,objects:Object.keys(p.selectedAreas)},null,8,["objects"])):(0,i.kq)("",!0)]),p.bgImage?((0,i.wg)(),(0,i.iD)("div",h,[(0,i.Wm)(v,{class:"tile","active-index":null==p.selectedArea?-1:0},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{disabled:null==p.selectedArea},{header:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.$t("view.selected_area")),1)])),default:(0,i.w5)((()=>[(0,i.Wm)(w,{class:"tile","model-value":p.selectedArea,"onUpdate:modelValue":t[0]||(t[0]=e=>u.onAreaSelect(e)),onDelete:t[1]||(t[1]=t=>e.areaDelete(p.selectedArea))},null,8,["model-value"])])),_:1},8,["disabled"])])),_:1},8,["active-index"]),(0,i.Wm)(v,{class:"tile","active-index":0},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{header:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.$t("model.heatmap.areas")),1)])),default:(0,i.w5)((()=>[null!=n.heatMap?((0,i.wg)(),(0,i.j4)(A,{key:0,modelValue:p.selectedArea,"onUpdate:modelValue":t[2]||(t[2]=e=>p.selectedArea=e),options:n.heatMap.areas,"option-label":"label",style:{width:"15rem"}},null,8,["modelValue","options"])):(0,i.kq)("",!0)])),_:1})])),_:1}),p.attributes?((0,i.wg)(),(0,i.j4)(v,{key:0,class:"tile","active-index":0},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{header:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.$t("model.heatmap.attributes")),1)])),default:(0,i.w5)((()=>[(0,i.Wm)(C,{"selection-keys":p.selectedAttributes,"onUpdate:selection-keys":t[3]||(t[3]=e=>p.selectedAttributes=e),value:p.attributes,"selection-mode":"checkbox"},null,8,["selection-keys","value"])])),_:1})])),_:1})):(0,i.kq)("",!0),p.settings.recommendationVisibility&&p.selectedAreas?((0,i.wg)(),(0,i.j4)(v,{key:1,class:"tile","active-index":-1},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{header:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.$t("model.heatmap.recommendations")),1)])),default:(0,i.w5)((()=>[(0,i.Wm)(K,{objects:p.selectedAreas},null,8,["objects"])])),_:1})])),_:1})):(0,i.kq)("",!0),p.settings.notificationVisibility&&p.selectedAreas?((0,i.wg)(),(0,i.j4)(v,{key:2,class:"tile","active-index":0},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{header:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.$t("model.heatmap.notifications")),1)])),default:(0,i.w5)((()=>[(0,i.Wm)(T,{objects:p.selectedAreas},null,8,["objects"])])),_:1})])),_:1})):(0,i.kq)("",!0),p.settings.measurementsVisibility&&p.selectedAreas?((0,i.wg)(),(0,i.j4)(v,{key:3,class:"tile","active-index":0},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{header:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.$t("view.measurements")),1)])),default:(0,i.w5)((()=>[(0,i.Wm)(M,{objects:p.selectedAreas},null,8,["objects"])])),_:1})])),_:1})):(0,i.kq)("",!0)])):(0,i.kq)("",!0)]),(0,i.Wm)($,{visible:p.settingsDialog,"onUpdate:visible":t[5]||(t[5]=e=>p.settingsDialog=e),style:{width:"50vw"},maximizable:!0,modal:!0,"dismissable-mask":!0},{default:(0,i.w5)((()=>[(0,i.Wm)(S,{onUpdate:t[4]||(t[4]=e=>u.reloadSettings())})])),_:1},8,["visible"])],64)}var u=n(6954),m=n(4019),g={name:"TreeNode",emits:["node-toggle","node-click","checkbox-change"],props:{node:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},templates:{type:null,default:null}},nodeTouched:!1,methods:{toggle(){this.$emit("node-toggle",this.node)},label(e){return"function"===typeof e.label?e.label():e.label},onChildNodeToggle(e){this.$emit("node-toggle",e)},onClick(e){u.p7.hasClass(e.target,"p-tree-toggler")||u.p7.hasClass(e.target.parentElement,"p-tree-toggler")||(this.isCheckboxSelectionMode()?this.toggleCheckbox():this.$emit("node-click",{originalEvent:e,nodeTouched:this.nodeTouched,node:this.node}),this.nodeTouched=!1)},onChildNodeClick(e){this.$emit("node-click",e)},onTouchEnd(){this.nodeTouched=!0},onKeyDown(e){const t=e.target.parentElement;switch(e.which){case 40:var n=t.children[1];if(n)this.focusNode(n.children[0]);else{const e=t.nextElementSibling;if(e)this.focusNode(e);else{let e=this.findNextSiblingOfAncestor(t);e&&this.focusNode(e)}}e.preventDefault();break;case 38:if(t.previousElementSibling)this.focusNode(this.findLastVisibleDescendant(t.previousElementSibling));else{let e=this.getParentNodeElement(t);e&&this.focusNode(e)}e.preventDefault();break;case 37:case 39:this.$emit("node-toggle",this.node),e.preventDefault();break;case 13:this.onClick(e),e.preventDefault();break}},toggleCheckbox(){let e=this.selectionKeys?{...this.selectionKeys}:{};const t=!this.checked;this.propagateDown(this.node,t,e),this.$emit("checkbox-change",{node:this.node,check:t,selectionKeys:e})},propagateDown(e,t,n){if(t?n[e.key]={checked:!0,partialChecked:!1}:delete n[e.key],e.children&&e.children.length)for(let i of e.children)this.propagateDown(i,t,n)},propagateUp(e){let t=e.check,n={...e.selectionKeys},i=0,s=!1;for(let l of this.node.children)n[l.key]&&n[l.key].checked?i++:n[l.key]&&n[l.key].partialChecked&&(s=!0);t&&i===this.node.children.length?n[this.node.key]={checked:!0,partialChecked:!1}:(t||delete n[this.node.key],s||i>0&&i!==this.node.children.length?n[this.node.key]={checked:!1,partialChecked:!0}:delete n[this.node.key]),this.$emit("checkbox-change",{node:e.node,check:e.check,selectionKeys:n})},onChildCheckboxChange(e){this.$emit("checkbox-change",e)},findNextSiblingOfAncestor(e){let t=this.getParentNodeElement(e);return t?t.nextElementSibling?t.nextElementSibling:this.findNextSiblingOfAncestor(t):null},findLastVisibleDescendant(e){const t=e.children[1];if(t){const e=t.children[t.children.length-1];return this.findLastVisibleDescendant(e)}return e},getParentNodeElement(e){const t=e.parentElement.parentElement;return u.p7.hasClass(t,"p-treenode")?t:null},focusNode(e){e.children[0].focus()},isCheckboxSelectionMode(){return"checkbox"===this.selectionMode}},computed:{hasChildren(){return this.node.children&&this.node.children.length>0},expanded(){return this.expandedKeys&&!0===this.expandedKeys[this.node.key]},leaf(){return!1!==this.node.leaf&&!(this.node.children&&this.node.children.length)},selectable(){return!1!==this.node.selectable&&null!=this.selectionMode},selected(){return!(!this.selectionMode||!this.selectionKeys)&&!0===this.selectionKeys[this.node.key]},containerClass(){return["p-treenode",{"p-treenode-leaf":this.leaf}]},contentClass(){return["p-treenode-content",this.node.styleClass,{"p-treenode-selectable":this.selectable,"p-highlight":this.checkboxMode?this.checked:this.selected}]},icon(){return["p-treenode-icon",this.node.icon]},toggleIcon(){return["p-tree-toggler-icon pi pi-fw",{"pi-chevron-down":this.expanded,"pi-chevron-right":!this.expanded}]},checkboxClass(){return["p-checkbox-box",{"p-highlight":this.checked,"p-indeterminate":this.partialChecked}]},checkboxIcon(){return["p-checkbox-icon",{"pi pi-check":this.checked,"pi pi-minus":this.partialChecked}]},checkboxMode(){return"checkbox"===this.selectionMode&&!1!==this.node.selectable},checked(){return!!this.selectionKeys&&(this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].checked)},partialChecked(){return!!this.selectionKeys&&(this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].partialChecked)}},directives:{ripple:m.Z}};const f={key:0,class:"p-checkbox p-component"},y={class:"p-treenode-label"},b={key:0,class:"p-treenode-children",role:"group"};function k(e,t,n,s,l,o){const d=(0,i.up)("TreeNode",!0),c=(0,i.Q2)("ripple");return(0,i.wg)(),(0,i.j4)("li",{class:o.containerClass},[(0,i.Wm)("div",{class:o.contentClass,tabindex:"0",role:"treeitem","aria-expanded":o.expanded,onClick:t[2]||(t[2]=(...e)=>o.onClick&&o.onClick(...e)),onKeydown:t[3]||(t[3]=(...e)=>o.onKeyDown&&o.onKeyDown(...e)),onTouchend:t[4]||(t[4]=(...e)=>o.onTouchEnd&&o.onTouchEnd(...e)),style:n.node.style},[(0,i.wy)((0,i.Wm)("button",{type:"button",class:"p-tree-toggler p-link",onClick:t[1]||(t[1]=(...e)=>o.toggle&&o.toggle(...e)),tabindex:"-1"},[(0,i.Wm)("span",{class:o.toggleIcon},null,2)],512),[[c]]),o.checkboxMode?((0,i.wg)(),(0,i.j4)("div",f,[(0,i.Wm)("div",{class:o.checkboxClass,role:"checkbox","aria-checked":o.checked},[(0,i.Wm)("span",{class:o.checkboxIcon},null,2)],10,["aria-checked"])])):(0,i.kq)("",!0),(0,i.Wm)("span",{class:o.icon},null,2),(0,i.Wm)("span",y,[n.templates[n.node.type]||n.templates["default"]?((0,i.wg)(),(0,i.j4)((0,i.LL)(n.templates[n.node.type]||n.templates["default"]),{key:0,node:n.node},null,8,["node"])):((0,i.wg)(),(0,i.j4)(i.HY,{key:1},[(0,i.Uk)((0,a.zw)(o.label(n.node)),1)],64))])],46,["aria-expanded"]),o.hasChildren&&o.expanded?((0,i.wg)(),(0,i.j4)("ul",b,[((0,i.wg)(!0),(0,i.j4)(i.HY,null,(0,i.Ko)(n.node.children,(e=>((0,i.wg)(),(0,i.j4)(d,{key:e.key,node:e,templates:n.templates,expandedKeys:n.expandedKeys,onNodeToggle:o.onChildNodeToggle,onNodeClick:o.onChildNodeClick,selectionMode:n.selectionMode,selectionKeys:n.selectionKeys,onCheckboxChange:o.propagateUp},null,8,["node","templates","expandedKeys","onNodeToggle","onNodeClick","selectionMode","selectionKeys","onCheckboxChange"])))),128))])):(0,i.kq)("",!0)],2)}g.render=k;var w={name:"Tree",emits:["node-expand","node-collapse","update:expandedKeys","update:selectionKeys","node-select","node-unselect"],props:{value:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},metaKeySelection:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner"},filter:{type:Boolean,default:!1},filterBy:{type:String,default:"label"},filterMode:{type:String,default:"lenient"},filterPlaceholder:{type:String,default:null},filterLocale:{type:String,default:void 0},scrollHeight:{type:String,default:null}},data(){return{d_expandedKeys:this.expandedKeys||{},filterValue:null}},watch:{expandedKeys(e){this.d_expandedKeys=e}},methods:{onNodeToggle(e){const t=e.key;this.d_expandedKeys[t]?(delete this.d_expandedKeys[t],this.$emit("node-collapse",e)):(this.d_expandedKeys[t]=!0,this.$emit("node-expand",e)),this.d_expandedKeys={...this.d_expandedKeys},this.$emit("update:expandedKeys",this.d_expandedKeys)},onNodeClick(e){if(null!=this.selectionMode&&!1!==e.node.selectable){const t=!e.nodeTouched&&this.metaKeySelection,n=t?this.handleSelectionWithMetaKey(e):this.handleSelectionWithoutMetaKey(e);this.$emit("update:selectionKeys",n)}},onCheckboxChange(e){this.$emit("update:selectionKeys",e.selectionKeys),e.check?this.$emit("node-select",e.node):this.$emit("node-unselect",e.node)},handleSelectionWithMetaKey(e){const t=e.originalEvent,n=e.node,i=t.metaKey||t.ctrlKey,s=this.isNodeSelected(n);let l;return s&&i?(this.isSingleSelectionMode()?l={}:(l={...this.selectionKeys},delete l[n.key]),this.$emit("node-unselect",n)):(this.isSingleSelectionMode()?l={}:this.isMultipleSelectionMode()&&(l=i&&this.selectionKeys?{...this.selectionKeys}:{}),l[n.key]=!0,this.$emit("node-select",n)),l},handleSelectionWithoutMetaKey(e){const t=e.node,n=this.isNodeSelected(t);let i;return this.isSingleSelectionMode()?n?(i={},this.$emit("node-unselect",t)):(i={},i[t.key]=!0,this.$emit("node-select",t)):n?(i={...this.selectionKeys},delete i[t.key],this.$emit("node-unselect",t)):(i=this.selectionKeys?{...this.selectionKeys}:{},i[t.key]=!0,this.$emit("node-select",t)),i},isSingleSelectionMode(){return"single"===this.selectionMode},isMultipleSelectionMode(){return"multiple"===this.selectionMode},isNodeSelected(e){return!(!this.selectionMode||!this.selectionKeys)&&!0===this.selectionKeys[e.key]},isChecked(e){return!!this.selectionKeys&&(this.selectionKeys[e.key]&&this.selectionKeys[e.key].checked)},isNodeLeaf(e){return!1!==e.leaf&&!(e.children&&e.children.length)},onFilterKeydown(e){13===e.which&&e.preventDefault()},findFilteredNodes(e,t){if(e){let n=!1;if(e.children){let i=[...e.children];e.children=[];for(let s of i){let i={...s};this.isFilterMatched(i,t)&&(n=!0,e.children.push(i))}}if(n)return!0}},isFilterMatched(e,{searchFields:t,filterText:n,strict:i}){let s=!1;for(let l of t){let t=String(u.gb.resolveFieldData(e,l)).toLocaleLowerCase(this.filterLocale);t.indexOf(n)>-1&&(s=!0)}return(!s||i&&!this.isNodeLeaf(e))&&(s=this.findFilteredNodes(e,{searchFields:t,filterText:n,strict:i})||s),s}},computed:{containerClass(){return["p-tree p-component",{"p-tree-selectable":null!=this.selectionMode,"p-tree-loading":this.loading,"p-tree-flex-scrollable":"flex"===this.scrollHeight}]},loadingIconClass(){return["p-tree-loading-icon pi-spin",this.loadingIcon]},filteredValue(){let e=[];const t=this.filterBy.split(","),n=this.filterValue.trim().toLocaleLowerCase(this.filterLocale),i="strict"===this.filterMode;for(let s of this.value){let l={...s},a={searchFields:t,filterText:n,strict:i};(i&&(this.findFilteredNodes(l,a)||this.isFilterMatched(l,a))||!i&&(this.isFilterMatched(l,a)||this.findFilteredNodes(l,a)))&&e.push(l)}return e},valueToRender(){return this.filterValue&&this.filterValue.trim().length>0?this.filteredValue:this.value}},components:{TreeNode:g}};const x={key:0,class:"p-tree-loading-overlay p-component-overlay"},v={key:1,class:"p-tree-filter-container"},A=(0,i.Wm)("span",{class:"p-tree-filter-icon pi pi-search"},null,-1),C={class:"p-tree-container",role:"tree"};function K(e,t,n,s,a,o){const d=(0,i.up)("TreeNode");return(0,i.wg)(),(0,i.j4)("div",{class:o.containerClass},[n.loading?((0,i.wg)(),(0,i.j4)("div",x,[(0,i.Wm)("i",{class:o.loadingIconClass},null,2)])):(0,i.kq)("",!0),n.filter?((0,i.wg)(),(0,i.j4)("div",v,[(0,i.wy)((0,i.Wm)("input",{type:"text",autocomplete:"off",class:"p-tree-filter p-inputtext p-component",placeholder:n.filterPlaceholder,onKeydown:t[1]||(t[1]=(...e)=>o.onFilterKeydown&&o.onFilterKeydown(...e)),"onUpdate:modelValue":t[2]||(t[2]=e=>a.filterValue=e)},null,40,["placeholder"]),[[l.nr,a.filterValue]]),A])):(0,i.kq)("",!0),(0,i.Wm)("div",{class:"p-tree-wrapper",style:{maxHeight:n.scrollHeight}},[(0,i.Wm)("ul",C,[((0,i.wg)(!0),(0,i.j4)(i.HY,null,(0,i.Ko)(o.valueToRender,(t=>((0,i.wg)(),(0,i.j4)(d,{key:t.key,node:t,templates:e.$slots,expandedKeys:a.d_expandedKeys,onNodeToggle:o.onNodeToggle,onNodeClick:o.onNodeClick,selectionMode:n.selectionMode,selectionKeys:n.selectionKeys,onCheckboxChange:o.onCheckboxChange},null,8,["node","templates","expandedKeys","onNodeToggle","onNodeClick","selectionMode","selectionKeys","onCheckboxChange"])))),128))])],4)],2)}function T(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!==typeof document){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===n&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var M="\n.p-tree-container {\n    margin: 0;\n    padding: 0;\n    list-style-type: none;\n    overflow: auto;\n}\n.p-treenode-children {\n    margin: 0;\n    padding: 0;\n    list-style-type: none;\n}\n.p-tree-wrapper {\n    overflow: auto;\n}\n.p-treenode-selectable {\n    cursor: pointer;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n.p-tree-toggler {\n    cursor: pointer;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    display: -webkit-inline-box;\n    display: -ms-inline-flexbox;\n    display: inline-flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    overflow: hidden;\n    position: relative;\n}\n.p-treenode-leaf > .p-treenode-content .p-tree-toggler {\n    visibility: hidden;\n}\n.p-treenode-content {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n.p-tree-filter {\n    width: 100%;\n}\n.p-tree-filter-container {\n    position: relative;\n    display: block;\n    width: 100%;\n}\n.p-tree-filter-icon {\n    position: absolute;\n    top: 50%;\n    margin-top: -.5rem;\n}\n.p-tree-loading {\n    position: relative;\n    min-height: 4rem;\n}\n.p-tree .p-tree-loading-overlay {\n    position: absolute;\n    z-index: 1;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n}\n.p-tree-flex-scrollable {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    height: 100%;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n.p-tree-flex-scrollable .p-tree-wrapper {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n}\n";T(M),w.render=K;var S=w,$=n(9394),j=n(4612);const _={style:{display:"block",width:"10rem"}};function N(e,t,n,s,l,o){return(0,i.wg)(),(0,i.iD)("div",_," todo view list of recommendation "+(0,a.zw)(l.mRecommendations)+" objects:"+(0,a.zw)(n.objects),1)}var I={name:"RecommendationView",components:{},props:{recommendations:{type:Array,default:()=>null},objects:{type:Array,default:null}},data(){return{mRecommendations:[]}},computed:{},watch:{objects:{handler:function(){},deep:!0}},created(){this.mRecommendations=this.recommendations},methods:{}},W=n(3744);const D=(0,W.Z)(I,[["render",N]]);var V=D,E=n(3561),z={name:"Accordion",emits:["tab-close","tab-open","update:activeIndex"],props:{multiple:{type:Boolean,default:!1},activeIndex:{type:[Number,Array],default:null},lazy:{type:Boolean,default:!1}},data(){return{d_activeIndex:this.activeIndex}},watch:{activeIndex(e){this.d_activeIndex=e}},methods:{onTabClick(e,t,n){if(!this.isTabDisabled(t)){const t=this.isTabActive(n),i=t?"tab-close":"tab-open";this.multiple?t?this.d_activeIndex=this.d_activeIndex.filter((e=>e!==n)):this.d_activeIndex?this.d_activeIndex.push(n):this.d_activeIndex=[n]:this.d_activeIndex=this.d_activeIndex===n?null:n,this.$emit("update:activeIndex",this.d_activeIndex),this.$emit(i,{originalEvent:e,index:n})}},onTabKeydown(e,t,n){13===e.which&&this.onTabClick(e,t,n)},isTabActive(e){return this.multiple?this.d_activeIndex&&this.d_activeIndex.includes(e):e===this.d_activeIndex},getKey(e,t){return e.props&&e.props.header?e.props.header:t},isTabDisabled(e){return e.props&&e.props.disabled},getTabClass(e){return["p-accordion-tab",{"p-accordion-tab-active":this.isTabActive(e)}]},getTabHeaderClass(e,t){return["p-accordion-header",{"p-highlight":this.isTabActive(t),"p-disabled":this.isTabDisabled(e)}]},getTabAriaId(e){return this.ariaId+"_"+e},getHeaderIcon(e){const t=this.isTabActive(e);return["p-accordion-toggle-icon pi",{"pi-chevron-right":!t,"pi-chevron-down":t}]},isAccordionTab(e){return"AccordionTab"===e.type.name}},computed:{tabs(){const e=[];return this.$slots.default().forEach((t=>{this.isAccordionTab(t)?e.push(t):t.children&&t.children instanceof Array&&t.children.forEach((t=>{this.isAccordionTab(t)&&e.push(t)}))})),e},ariaId(){return(0,u.Th)()}}};const H={class:"p-accordion p-component"},F={key:0,class:"p-accordion-header-text"},L={class:"p-accordion-content"};function O(e,t,n,s,o,d){return(0,i.wg)(),(0,i.j4)("div",H,[((0,i.wg)(!0),(0,i.j4)(i.HY,null,(0,i.Ko)(d.tabs,((e,t)=>((0,i.wg)(),(0,i.j4)("div",{key:d.getKey(e,t),class:d.getTabClass(t)},[(0,i.Wm)("div",{class:d.getTabHeaderClass(e,t)},[(0,i.Wm)("a",{role:"tab",class:"p-accordion-header-link",onClick:n=>d.onTabClick(n,e,t),onKeydown:n=>d.onTabKeydown(n,e,t),tabindex:d.isTabDisabled(e)?null:"0","aria-expanded":d.isTabActive(t),id:d.getTabAriaId(t)+"_header","aria-controls":d.getTabAriaId(t)+"_content"},[(0,i.Wm)("span",{class:d.getHeaderIcon(t)},null,2),e.props&&e.props.header?((0,i.wg)(),(0,i.j4)("span",F,(0,a.zw)(e.props.header),1)):(0,i.kq)("",!0),e.children&&e.children.header?((0,i.wg)(),(0,i.j4)((0,i.LL)(e.children.header),{key:1})):(0,i.kq)("",!0)],40,["onClick","onKeydown","tabindex","aria-expanded","id","aria-controls"])],2),(0,i.Wm)(l.uT,{name:"p-toggleable-content"},{default:(0,i.w5)((()=>[!n.lazy||d.isTabActive(t)?(0,i.wy)(((0,i.wg)(),(0,i.j4)("div",{key:0,class:"p-toggleable-content",role:"region",id:d.getTabAriaId(t)+"_content","aria-labelledby":d.getTabAriaId(t)+"_header"},[(0,i.Wm)("div",L,[((0,i.wg)(),(0,i.j4)((0,i.LL)(e)))])],8,["id","aria-labelledby"])),[[l.F8,!!n.lazy||d.isTabActive(t)]]):(0,i.kq)("",!0)])),_:2},1024)],2)))),128))])}function U(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!==typeof document){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===n&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var B="\n.p-accordion-header-link {\n    cursor: pointer;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    position: relative;\n    text-decoration: none;\n}\n.p-accordion-header-link:focus {\n    z-index: 1;\n}\n.p-accordion-header-text {\n    line-height: 1;\n}\n";U(B),z.render=O;var q=z,Z={name:"AccordionTab",props:{header:null,disabled:Boolean}};function P(e,t,n,s,l,a){return(0,i.WI)(e.$slots,"default")}Z.render=P;var R=Z,Y=n(3609),Q=n(8382),X=n(9649),G=n(2125);function J(e,t,n,s,l,a){const o=(0,i.up)("Settings");return(0,i.wg)(),(0,i.j4)(o,{schema:l.schema,model:l.model},null,8,["schema","model"])}var ee=n(6062),te={name:"HeatmapSettings",components:{Settings:ee.Z},props:{},emits:["update"],data(){return{model:this.$store.getters["settings/heatmap"],panels:[],schema:{}}},computed:{},watch:{model:{handler:function(e){this.$store.commit("settings/heatmap",e),this.$emit("update")},deep:!0}},async mounted(){this.$ren.dashboardApi.informationPanelList().then((e=>{this.panels=e})).then((()=>{this.schema=this.getSchema()}))},async created(){this.schema=this.getSchema()},methods:{getSchema(){var e=[{label:this.$t("settings.recommendations"),ext:{true:this.$t("settings.visible"),false:this.$t("settings.hidden")},type:Boolean,key:"recommendationVisibility"},{label:this.$t("settings.measurements"),ext:{true:this.$t("settings.visible"),false:this.$t("settings.hidden")},type:Boolean,key:"measurementsVisibility"},{label:this.$t("settings.notification"),ext:{true:this.$t("settings.visible"),false:this.$t("settings.hidden")},type:Boolean,key:"notificationVisibility"}];return e},toggle(e){this.$refs.menu.toggle(e)}}};const ne=(0,W.Z)(te,[["render",J]]);var ie=ne,se=n(1079);const le={class:"p-fluid"},ae=["for"],oe={class:"col-12"},de=["id"];function ce(e,t,n,s,l,o){return(0,i.wg)(),(0,i.iD)("div",le,[(0,i.Uk)(" TODO: measurements view "+(0,a.zw)(n.objects)+" "+(0,a.zw)(l.measurements.length)+"dddddd "+(0,a.zw)(l.measurements)+" ",1),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.measurements,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:(0,a.C_)("field grid")},[(0,i._)("label",{for:t.key,class:"col-12"},(0,a.zw)(e.$t("model.measurements"+t.key)),9,ae),(0,i._)("div",oe,[(0,i._)("span",{id:t.key},(0,a.zw)(t.value),9,de)])])))),128))])}var re={name:"MeasurementsView",components:{},props:{objects:{type:Object,default:()=>({})}},data(){return{measurements:[],objectsId:[]}},watch:{objects:{handler:function(e){this.objectsId=Object.keys(e),this.refresh()},deep:!0}},created(){this.objectsId=Object.keys(this.objects),this.refresh()},methods:{async refresh(){await this.$ren.measurementApi.getCurrentMeasurements(Object.keys(this.objectsId)).then((e=>{this.measurements=e}))}}};const he=(0,W.Z)(re,[["render",ce]]);var pe=he;const ue=900,me=450;var ge={name:"HeatMapView",components:{Card:Q.Z,Listbox:E.Z,AreaDetails:j.Z,Accordion:q,AccordionTab:R,Tree:S,HeatMapSettings:ie,RecommendationView:V,DotMenu:$.Z,NotificationView:G.Z,MeasurementChart:se.Z,MeasurementsView:pe,Dialog:Y.Z},props:{heatMap:{type:Object,default:()=>null}},data(){return{stageSize:{width:ue,height:me},selectedArea:null,scale:1,bgImage:null,selectedAreas:{},attributes:null,selectedAttributes:[],recommendations:null,recommendationPanelState:-1,measurmenentState:!0,settingsDialog:!1,settings:this.$store.getters["settings/heatmap"]}},watch:{selectedAreas:{handler:async function(e){e&&Object.keys(e).length>0?await this.loadAttributes():this.attributes=null},deep:!0},heatMap:function(){if(null!=this.heatMap){const e=new window.Image;e.src=this.heatMap.imgUrl,e.onload=()=>{this.bgImage=e;let t=this.$refs.stage.getStage();this.scaleHeatMap(t,e),this.heatMap.areas.forEach(((e,t)=>this.drawArea(e,t)))}}else console.info("todo: null")}},mounted(){if(null!=this.heatMap){const e=new window.Image;e.src=this.heatMap.imgUrl,e.onload=()=>{this.bgImage=e;let t=this.$refs.stage.getStage();this.scaleHeatMap(t,e),this.heatMap.areas.forEach(((e,t)=>this.drawArea(e,t)))}}},methods:{reloadSettings(){this.settings=this.$store.getters["settings/heatmap"]},onAreaSelect(e){if(null!=this.selectedArea){let e=this.selectedArea.id;this.toggleArea(e,!1)}if(null!=e){Object.keys(this.selectedAreas).forEach((e=>{this.toggleArea(e,!1)}));let t={};t[e.id]=1,this.selectedAreas=t;let n=e.id;this.toggleArea(n,!0)}},toggleArea(e,t){let n=this.$refs.stage.getStage().findOne(`#${e}`);null!=n&&(t?n.fill("#AAAAFFAA"):n.fill("#00D2FFAA"))},onClick(e){if("CANVAS"==e.target.nodeName&&this.addMode){let n=this.$refs.stage.getStage();var t=n.findOne(`#${this.current.id}`);if(null!=t){this.current.points.push([e.layerX/this.scale,e.layerY/this.scale]);let n=this.current.points,i=(e,t)=>{e.beginPath(),n.forEach((t=>{e.lineTo(t[0],t[1])})),e.closePath(),e.fillStrokeShape(t)};t.setSceneFunc(i)}}},drawArea(e,t){let n=new X["default"].Layer,i=this.$refs.stage.getStage(),s=new X["default"].Shape(this.getConfig(e)),l=e.id;s.on("click",(()=>{this.selectedArea=this.heatMap.areas[t],1==this.selectedAreas[l]?(1==this.selectedAreas.length?this.selectedAreas={}:delete this.selectedAreas[l],this.toggleArea(e.id,!1)):(this.selectedAreas[l]=1,this.toggleArea(e.id,!0));let n=Object.keys(this.selectedAreas);if(1!=n.length)this.selectedArea=null;else{let e=Object.keys(this.selectedAreas);this.heatMap.areas.forEach((t=>{t.id==e[0]&&(this.selectedArea=t)}))}})),n.add(s),i.add(n),i.draw()},getConfig(e){return{sceneFunc:function(t,n){t.beginPath(),console.info(e),e.points.forEach((e=>{t.lineTo(e[0],e[1])})),t.closePath(),t.fillStrokeShape(n)},fill:"#00D2FFAA",stroke:"black",strokeWidth:1,opacity:.75,listening:!0,id:e.id}},async loadAttributes(){await this.$ren.measurementApi.attributes(Object.keys(this.selectedAreas)).then((e=>{this.attributes=e}))},scaleHeatMap(e,t){if(null!=t){var n=ue/t.width;this.scale=n,e.width(t.width),e.height(t.height),e.scale({x:n,y:n})}},menuModel(){return[{label:this.$t("menu.settings"),icon:"pi pi-fw pi-eye",command:()=>{this.settingsDialog=!this.settingsDialog}}]}}};const fe=(0,W.Z)(ge,[["render",p]]);var ye=fe,be={name:"HeatMap",components:{HeatMapView:ye},data(){return{heatmap:null}},async created(){this.$ren.dashboardApi.getHeatMap(this.$route.params.id).then((e=>{this.heatmap=e})).catch((e=>{this.$toast.add({severity:"error",summary:this.$t("view.toast.get_heatmap",{label:this.label,error:e}),life:3e3})}))},mounted(){},methods:{}};const ke=(0,W.Z)(be,[["render",s]]);var we=ke}}]);
//# sourceMappingURL=42.04f6c53d.js.map