"use strict";(self["webpackChunkrenergetic_ui"]=self["webpackChunkrenergetic_ui"]||[]).push([[533],{4533:function(e,t,s){s.r(t),s.d(t,{default:function(){return j}});s(8862),s(8309);var r=s(6252),i=s(3577),a=function(e){return(0,r.dD)("data-v-7dd8a968"),e=e(),(0,r.Cn)(),e},l={key:0,class:"orders-subtable",style:{margin:"0 2rem"}},n={key:2,class:"grid p-fluid",style:{margin:"0 2rem"}},o={class:"col-12 md:col-4"},u={class:"p-inputgroup"},d=["onChange"],c=["value"],m={class:"confirmation-content"},p=a((function(){return(0,r._)("i",{class:"pi pi-exclamation-circle mr-3",style:{"font-size":"2rem",margin:"0em 0.4em"}},null,-1)})),h={key:0};function f(e,t,s,a,f,v){var g=(0,r.up)("Column"),b=(0,r.up)("Button"),y=(0,r.up)("DataTable"),w=(0,r.up)("Message"),k=(0,r.up)("Toolbar"),U=(0,r.up)("Dialog"),D=(0,r.up)("UserAdd");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(y,{expandedRows:f.users.roles,"onUpdate:expandedRows":t[0]||(t[0]=function(e){return f.users.roles=e}),value:f.users,"data-key":"id","responsive-layout":"scroll"},{expansion:(0,r.w5)((function(e){return[void 0!=e.data.roles&&e.data.roles.length>0?((0,r.wg)(),(0,r.iD)("div",l,[(0,r.Wm)(y,{value:e.data.roles,"responsive-layout":"scroll"},{default:(0,r.w5)((function(){return[(0,r.Wm)(g,{exportable:!1,style:{"min-width":"8rem"}},{body:(0,r.w5)((function(t){return[(0,r.Wm)(b,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:function(s){return v.openDialog("deleteRole",e.data,t.data)}},null,8,["onClick"])]})),_:2},1024),(0,r.Wm)(g,{field:"name",header:"Role Name",sortable:""})]})),_:2},1032,["value"])])):((0,r.wg)(),(0,r.j4)(w,{key:1,severity:"info"},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,i.zw)("".concat(e.data.username," haven't assigned roles")),1)]})),_:2},1024)),v.availableRoles(e.data).length>0?((0,r.wg)(),(0,r.iD)("div",n,[(0,r._)("div",o,[(0,r._)("div",u,[(0,r._)("select",{class:"p-component",style:{width:"100%","text-align":"center"},onChange:function(t){return v.selectRole(t,e.data)}},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(v.availableRoles(e.data),(function(e){return(0,r.wg)(),(0,r.iD)("option",{key:e.id,value:JSON.stringify(e)},(0,i.zw)(e.name),9,c)})),128))],40,d),(0,r.Wm)(b,{icon:"pi pi-plus",class:"p-button-success",onClick:function(t){return v.addRole(e.data)}},null,8,["onClick"])])])])):(0,r.kq)("",!0)]})),default:(0,r.w5)((function(){return[(0,r.Wm)(g,{expander:!0,"header-style":"width: 3rem"}),(0,r.Wm)(g,{field:"username",header:"Username",sortable:""}),(0,r.Wm)(g,{field:"name",header:"Name",sortable:""}),(0,r.Wm)(g,{field:"email",header:"Email",sortable:""}),(0,r.Wm)(g,{exportable:!1,style:{"min-width":"8rem"}},{body:(0,r.w5)((function(e){return[(0,r.Wm)(b,{icon:"pi pi-user-edit",class:"p-button-rounded p-button-warning mr-2",onClick:function(t){f.userToEdit=e.data,f.addUserDialog=!0}},null,8,["onClick"]),(0,r.Wm)(b,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:function(t){return v.openDialog("deleteUser",e.data)}},null,8,["onClick"])]})),_:1})]})),_:1},8,["expandedRows","value"]),(0,r.Wm)(k,null,{start:(0,r.w5)((function(){return[(0,r.Wm)(b,{label:"Add new user",icon:"pi pi-user-plus",class:"mr-2 p-button-success",onClick:t[1]||(t[1]=function(e){f.userToEdit=void 0,f.addUserDialog=!0})})]})),_:1}),(0,r.Wm)(U,{visible:f.deleteDialog.visible,"onUpdate:visible":t[4]||(t[4]=function(e){return f.deleteDialog.visible=e}),style:{width:"450px"},header:f.deleteDialog.header,modal:!0},{footer:(0,r.w5)((function(){return[(0,r.Wm)(b,{label:"No",icon:"pi pi-times",class:"p-button-text",style:{color:"var(--orange-300)"},onClick:t[2]||(t[2]=function(e){return f.deleteDialog.visible=!1})}),(0,r.Wm)(b,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:t[3]||(t[3]=function(e){return v.deleteResource()})})]})),default:(0,r.w5)((function(){return[(0,r._)("div",m,[p,f.userToChange?((0,r.wg)(),(0,r.iD)("span",h,(0,i.zw)(f.deleteDialog.text),1)):(0,r.kq)("",!0)])]})),_:1},8,["visible","header"]),(0,r.Wm)(D,{users:f.users,"edit-user":f.userToEdit,visible:f.addUserDialog,onClose:v.closeAddUserDialog},null,8,["users","edit-user","visible","onClose"])])}var v=s(6347),g=s(5082),b=s(8534),y=(s(1249),s(561),s(2222),s(5666),function(e){return(0,r.dD)("data-v-ec38c472"),e=e(),(0,r.Cn)(),e}),w={class:"p-fluid grid"},k={class:"p-float-label p-my-4"},U=y((function(){return(0,r._)("label",{for:"username"},"Username",-1)})),D={class:"p-float-label p-my-4"},C=y((function(){return(0,r._)("label",{for:"firstname"},"User First Name",-1)})),x={class:"p-float-label p-my-4"},_=y((function(){return(0,r._)("label",{for:"lastname"},"User Surname",-1)})),R={class:"p-float-label p-my-4"},W=y((function(){return(0,r._)("label",{for:"email"},"User E-mail",-1)})),T={class:"p-float-label p-my-4"},A=y((function(){return(0,r._)("label",{for:"email"},"User Password",-1)}));function V(e,t,s,a,l,n){var o=(0,r.up)("InputText"),u=(0,r.up)("Password"),d=(0,r.up)("ToggleButton"),c=(0,r.up)("Button"),m=(0,r.up)("Dialog");return(0,r.wg)(),(0,r.j4)(m,{visible:s.visible,style:{width:"450px"},header:"Add new user",modal:!0,"onUpdate:visible":n.cancelAdd},{footer:(0,r.w5)((function(){return[(0,r.Wm)(c,{label:"No",icon:"pi pi-times",class:"p-button-text p-left",style:{color:"var(--orange-300)"},onClick:t[6]||(t[6]=function(e){return n.cancelAdd()})}),(0,r.Wm)(c,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:t[7]||(t[7]=function(e){return n.confirmAdd()})})]})),default:(0,r.w5)((function(){return[(0,r._)("div",w,[(0,r._)("span",k,[(0,r.Wm)(o,{id:"username",modelValue:l.user.username,"onUpdate:modelValue":t[0]||(t[0]=function(e){return l.user.username=e}),type:"text",class:(0,i.C_)(l.error.username?"p-invalid":"")},null,8,["modelValue","class"]),U]),(0,r._)("span",D,[(0,r.Wm)(o,{id:"firstname",modelValue:l.user.firstName,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.user.firstName=e}),type:"text"},null,8,["modelValue"]),C]),(0,r._)("span",x,[(0,r.Wm)(o,{id:"lastname",modelValue:l.user.lastName,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.user.lastName=e}),type:"text"},null,8,["modelValue"]),_]),(0,r._)("span",R,[(0,r.Wm)(o,{id:"email",modelValue:l.user.email,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.user.email=e}),type:"text",class:(0,i.C_)(l.error.email?"p-invalid":"")},null,8,["modelValue","class"]),W]),(0,r._)("span",T,[(0,r.Wm)(u,{id:"password",modelValue:l.user.credentials[0].value,"onUpdate:modelValue":t[4]||(t[4]=function(e){return l.user.credentials[0].value=e}),class:(0,i.C_)(l.error.password?"p-invalid":"")},null,8,["modelValue","class"]),A]),(0,r.Wm)(d,{modelValue:l.user.credentials[0].temporary,"onUpdate:modelValue":t[5]||(t[5]=function(e){return l.user.credentials[0].temporary=e}),"on-label":"Temporal Password","off-label":"Permanent Password","on-icon":"pi pi-check","off-icon":"pi pi-times"},null,8,["modelValue"])])]})),_:1},8,["visible","onUpdate:visible"])}var N={name:"UserAdd",props:{users:{type:Array,required:!0},editUser:{type:Object,required:!1,default:void 0},visible:Boolean},emits:["close"],data:function(){return{user:{enabled:!0,attributes:{},groups:[],username:void 0,firstName:void 0,lastName:void 0,email:void 0,emailVerified:"false",credentials:[{type:"password",value:void 0,temporary:!0}]},error:{username:!1,email:!1,password:!1}}},watch:{visible:function(e){e?void 0!=this.editUser&&(this.user=this.editUser,this.user.credentials=[{type:"password",value:void 0,temporary:!0}],delete this.user.roles,delete this.user.name):this.reset()}},methods:{confirmAdd:function(){var e=this,t=!1;console.error(this.user);var s,r=(0,v.Z)(this.users);try{for(r.s();!(s=r.n()).done;){var i=s.value;void 0!==this.user.username&&(this.user.username!==i.username||void 0!=this.editUser&&this.user.username==this.editUser.username)||(t=!0,this.error.username=!0),void 0==this.user.email||this.user.email!==i.email||void 0!=this.editUser&&this.user.email==this.editUser.email||(t=!0,this.error.email=!0)}}catch(a){r.e(a)}finally{r.f()}void 0!=this.editUser&&void 0===this.user.credentials[0].value?delete this.user.credentials:void 0!==this.user.credentials[0].value&&0!=this.user.credentials[0].value||(t=!0,this.error.password=!0),t||void 0!==this.editUser?t||this.$keycloak.updateUser(this.user).then((function(){e.$emit("close",e.user)})):this.$keycloak.createUser(this.user).then((function(){e.$emit("close",e.user)}))},cancelAdd:function(){this.$emit("close",void 0)},reset:function(){Object.assign(this.$data,this.$options.data.apply(this))}}},$=s(3744);const O=(0,$.Z)(N,[["render",V],["__scopeId","data-v-ec38c472"]]);var Z=O,E={name:"Users",components:{UserAdd:Z},data:function(){return{users:[],roles:[],userToEdit:void 0,userToChange:void 0,roleToChange:void 0,deleteDialog:{visible:!1,header:"Delete",text:"Are you sure to delete this",delete:void 0},addUserDialog:!1}},created:function(){var e=this;return(0,b.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$keycloak.getUsers();case 2:return e.users=t.sent,t.next=5,e.$keycloak.getClientRoles();case 5:e.roles=t.sent;case 6:case"end":return t.stop()}}),t)})))()},mounted:function(){},methods:{availableRoles:function(e){var t,s=this.roles.map((function(e){return(0,g.Z)({},e)})),r=(0,v.Z)(e.roles);try{for(r.s();!(t=r.n()).done;){var i=t.value;s.splice(s.map((function(e){return e.id})).indexOf(i.id),1)}}catch(a){r.e(a)}finally{r.f()}return void 0!=s&&s.length>0&&(e.addRole=s[0]),s},openDialog:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;switch(this.userToChange=t,this.roleToChange=s,e){case"deleteRole":this.deleteDialog.delete="role",this.deleteDialog.header="Delete Role",this.deleteDialog.text="Are you sure to delete ".concat(s.name," role from ").concat(t.username,"?"),this.deleteDialog.visible=!0;break;case"deleteUser":this.deleteDialog.delete="user",this.deleteDialog.header="Delete User",this.deleteDialog.text="Are you sure to delete ".concat(t.username,"? This action cannot be reversed"),this.deleteDialog.visible=!0;break;default:this.deleteDialog.delete=void 0;break}},closeAddUserDialog:function(e){var t=this;return(0,b.Z)(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(void 0==e){s.next=5;break}return s.next=3,t.$keycloak.getUsers();case 3:t.users=s.sent,console.log(t.users);case 5:t.addUserDialog=!1;case 6:case"end":return s.stop()}}),s)})))()},addRole:function(e){void 0!=e.addRole&&(console.error(e.addRole),this.$keycloak.assignRolesToUser(e.id,Array(e.addRole)),e.roles.push(e.addRole))},selectRole:function(e,t){t.addRole=JSON.parse(e.target.value)},deleteResource:function(){if("role"==this.deleteDialog.delete&&this.userToChange&&this.roleToChange){var e=this.users[this.users.indexOf(this.userToChange)];console.error(e),this.$keycloak.unAssignRolesToUser(this.userToChange.id,Array(this.roleToChange)),e.roles.splice(e.roles.indexOf(this.roleToChange),1),this.deleteDialog.visible=!1,this.deleteDialog.delete=void 0}else"user"==this.deleteDialog.delete&&this.userToChange&&(this.$keycloak.deleteUser(this.userToChange.id),this.users.splice(this.users.indexOf(this.userToChange),1),this.deleteDialog.visible=!1,this.deleteDialog.delete=void 0)}}};const P=(0,$.Z)(E,[["render",f],["__scopeId","data-v-7dd8a968"]]);var j=P}}]);
//# sourceMappingURL=533-legacy.99cdd44d.js.map